(()=>{var e={};e.id=5043,e.ids=[5043],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},31071:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>y,routeModule:()=>w,serverHooks:()=>v,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>L});var s={};t.r(s),t.d(s,{DELETE:()=>b,GET:()=>h,POST:()=>m});var i=t(96559),o=t(48088),n=t(37719),a=t(36463),u=t(32190),c=t(72289),d=t(56621),l=t(43091),g=t(47709);let p=c.Ik({submissionId:c.Yj().uuid(),rating:c.ai().min(1).max(5),comment:c.Yj().optional(),helpfulness:c.ai().min(1).max(5).optional(),accuracy:c.ai().min(1).max(5).optional()}),f=c.Ik({submissionId:c.Yj().uuid().optional(),limit:c.au.number().min(1).max(100).optional(),offset:c.au.number().min(0).optional()});async function m(e){try{let r=await (0,d.b)(),{data:{session:t}}=await r.auth.getSession();if(!t)return u.NextResponse.json({error:"Unauthorized"},{status:401});let s=t.user,i=await e.json(),o=(0,g.sv)(p,i),{data:n,error:c}=await r.from("submissions").select("id").eq("id",o.submissionId).eq("user_id",s.id).single();if(c||!n)return(0,l.HN)("Submission not found");let{data:f,error:m}=await r.from("user_feedback").insert({submission_id:o.submissionId,user_id:s.id,rating:o.rating,comment:o.comment,helpfulness:o.helpfulness,accuracy:o.accuracy}).select("*").single();if(m||!f)return a.v.error("Supabase feedback creation error:",m),(0,l.yj)("Failed to create feedback",500);return(0,l.r6)(f,"Feedback submitted successfully")}catch(e){return a.v.error("Feedback POST error:",e),(0,l.yj)("Internal server error",500)}}async function h(e){try{let r=await (0,d.b)(),{data:{session:t}}=await r.auth.getSession();if(!t)return u.NextResponse.json({error:"Unauthorized"},{status:401});let s=t.user,{searchParams:i}=new URL(e.url),o=(0,g.Rq)(f,i),n=r.from("user_feedback").select(`
        *,
        submissions (
          id,
          question,
          subject,
          exam_board,
          created_at
        )
      `).eq("user_id",s.id).order("created_at",{ascending:!1}).range(o.offset||0,(o.offset||0)+(o.limit||50)-1);o.submissionId&&(n=n.eq("submission_id",o.submissionId));let{data:c,error:p}=await n;if(p)return a.v.error("Supabase feedback query error:",p),(0,l.yj)("Failed to fetch feedback",500);return(0,l.r6)(c)}catch(e){return a.v.error("Feedback GET error:",e),(0,l.yj)("Internal server error",500)}}async function b(e){try{let r=await (0,d.b)(),{data:{session:t}}=await r.auth.getSession();if(!t)return u.NextResponse.json({error:"Unauthorized"},{status:401});let s=t.user,{searchParams:i}=new URL(e.url),o=i.get("id");if(!o)return(0,l.yj)("Feedback ID is required",400);let{error:n}=await r.from("user_feedback").delete().eq("id",o).eq("user_id",s.id);if(n)return a.v.error("Supabase feedback delete error:",n),(0,l.yj)("Failed to delete feedback",500);return(0,l.r6)(null,"Feedback deleted successfully")}catch(e){return a.v.error("Feedback DELETE error:",e),(0,l.yj)("Internal server error",500)}}let w=new i.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/feedback/route",pathname:"/api/feedback",filename:"route",bundlePath:"app/api/feedback/route"},resolvedPagePath:"/home/new_username/Documents/projects/aiamrkerv2/worktrees/claude/src/app/api/feedback/route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:x,workUnitAsyncStorage:L,serverHooks:v}=w;function y(){return(0,n.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:L})}},34631:e=>{"use strict";e.exports=require("tls")},36463:(e,r,t)=>{"use strict";t.d(r,{v:()=>i});class s{constructor(){this.logLevel=process.env.NEXT_PUBLIC_LOG_LEVEL||"info",this.setupProductionLogging()}static getInstance(){return s.instance||(s.instance=new s),s.instance}shouldLog(e){let r={debug:0,info:1,warn:2,error:3};return r[e]>=r[this.logLevel]}formatMessage(e,r,t){let s=new Date().toISOString(),i=t?` ${JSON.stringify(t)}`:"";return`[${s}] [${e.toUpperCase()}] ${r}${i}`}async setupProductionLogging(){try{let{getEnvVar:e}=await Promise.resolve().then(t.bind(t,43294)),r=await e("LOGGING_SERVICE");if("sentry"===r)await e("SENTRY_DSN")&&console.warn("Sentry logging not available in Cloudflare Workers environment");else if("logflare"===r){let r=await e("LOGFLARE_API_KEY"),t=await e("LOGFLARE_SOURCE_ID");r&&t&&console.warn("Winston-Logflare logging not available in Cloudflare Workers environment")}else if("datadog"===r){let r=await e("DATADOG_API_KEY");if(r){let{datadogLogs:e}=await t.e(6666).then(t.bind(t,96666));e.init({clientToken:r,site:"datadoghq.com",forwardErrorsToLogs:!0}),this.productionLogger=e}}}catch(e){console.error("Failed to initialize production logging:",e)}}debug(e,r){this.shouldLog("debug")&&console.debug(this.formatMessage("debug",e,r))}info(e,r){this.shouldLog("info")&&(console.info(this.formatMessage("info",e,r)),this.productionLogger&&(this.productionLogger.captureMessage?this.productionLogger.captureMessage(e,"info",r):this.productionLogger.logger&&this.productionLogger.logger.info(e,r)))}warn(e,r){this.shouldLog("warn")&&(console.warn(this.formatMessage("warn",e,r)),this.productionLogger&&(this.productionLogger.captureMessage?this.productionLogger.captureMessage(e,"warning",r):this.productionLogger.logger&&this.productionLogger.logger.warn(e,r)))}error(e,r,t){if(this.shouldLog("error")){let s=r?{error:r.message||r,stack:r.stack}:{};console.error(this.formatMessage("error",e,{...t,...s})),this.productionLogger&&(this.productionLogger.captureException?this.productionLogger.captureException(r||Error(e),{contexts:{context:t}}):this.productionLogger.logger&&this.productionLogger.logger.error(e,{...t,...s}))}}}let i=s.getInstance()},39727:()=>{},43091:(e,r,t)=>{"use strict";t.d(r,{HN:()=>n,r6:()=>i,yj:()=>o});var s=t(32190);function i(e,r,t=200){return s.NextResponse.json({success:!0,data:e,message:r,statusCode:t},{status:t})}function o(e,r=500,t){return s.NextResponse.json({success:!1,error:e,data:t,statusCode:r},{status:r})}function n(e="Not found"){return o(e,404)}},43294:(e,r,t)=>{"use strict";t.d(r,{getEnvVar:()=>o});var s=t(62426);async function i(){try{return(await (0,s.DM)()).env}catch(e){return process.env}}async function o(e){return(await i())[e]}},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},47709:(e,r,t)=>{"use strict";function s(e,r){return e.parse(r)}function i(e,r){let t=Object.fromEntries(r);return e.parse(t)}t.d(r,{Rq:()=>i,sv:()=>s}),t(43091)},47990:()=>{},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},56621:(e,r,t)=>{"use strict";t.d(r,{b:()=>n});var s=t(66437),i=t(43294);let o=null;async function n(){if(!o){let e=await (0,i.getEnvVar)("NEXT_PUBLIC_SUPABASE_URL"),r=await (0,i.getEnvVar)("NEXT_PUBLIC_SUPABASE_ANON_KEY");if(!e||!r)throw Error("Missing Supabase configuration");o=(0,s.UU)(e,r)}return o}(0,s.UU)("https://tqlnqqrrpzmdpgijxiqk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRxbG5xcXJycHptZHBnaWp4aXFrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTExMTUwNjAsImV4cCI6MjA2NjY5MTA2MH0.ZDCY7DSswAgcUHFlDl3S0BDDXpX3qmyViWXsIGFhwkw")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},96487:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[4243,2822,580,2289],()=>t(31071));module.exports=s})();