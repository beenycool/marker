(()=>{var e={};e.id=4662,e.ids=[4662],e.modules={3107:(e,t,r)=>{Promise.resolve().then(r.bind(r,46771)),Promise.resolve().then(r.bind(r,12304))},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},5069:(e,t,r)=>{"use strict";r.d(t,{L:()=>a,db:()=>i});var s=r(56621);async function a(){return await (0,s.b)()}let i=(0,s.b)()},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},10974:(e,t,r)=>{"use strict";r.d(t,{cn:()=>i});var s=r(75986),a=r(8974);function i(...e){return(0,a.QP)((0,s.$)(e))}},11997:e=>{"use strict";e.exports=require("punycode")},12304:(e,t,r)=>{"use strict";r.d(t,{Separator:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call Separator() from the server but Separator is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/new_username/Documents/projects/aiamrkerv2/worktrees/claude/src/components/ui/separator.tsx","Separator")},12640:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(62688).A)("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]])},12909:(e,t,r)=>{"use strict";r.d(t,{HW:()=>n,hS:()=>o,rN:()=>l});var s=r(36463),a=r(56621);let i=new Map;async function n(){let e,t=await (0,a.b)(),{data:{session:r},error:n}=await t.auth.getSession();if(n||!r)return null;let o=r.user.id,l=r.user.email||"",c=`user:${o}`,d=i.get(c);if(d&&Date.now()-d.timestamp<6e4)return d.user;let{data:u,error:g}=await t.from("users").select("*").eq("id",o).single();if(u){let{data:r,error:a}=await t.from("users").update({email:l,updated_at:new Date().toISOString()}).eq("id",o).select("*").single();if(a)return s.v.error("Error updating user:",a),null;e=r}else{let{data:r,error:a}=await t.from("users").insert({id:o,email:l,subscription_tier:"FREE",role:"STUDENT",onboarding_completed:!1}).select("*").single();if(a)return s.v.error("Error creating user:",a),null;e=r}if(i.set(c,{user:e,timestamp:Date.now()}),i.size>50){let e=Date.now();for(let[t,r]of i.entries())e-r.timestamp>6e4&&i.delete(t)}return e}async function o(e){let t=await (0,a.b)(),{data:r}=await t.rpc("is_feature_active",{flag_name:"summer_promotion_2024"}),{data:i,error:n}=await t.from("users").select("*").eq("id",e).single();if(n||!i)return{canUse:!1,usedToday:0,limit:0};let o=new Date;o.setHours(0,0,0,0);let l=o.toISOString().split("T")[0],{data:c}=await t.from("usage_tracking").select("*").eq("user_id",e).eq("date",l).single(),d=c;if(!c){let{data:e,error:r}=await t.from("usage_tracking").insert({user_id:i.id,date:l,api_calls_used:0,tier:i.subscription_tier}).select("*").single();if(r)return s.v.error("Error creating usage tracking:",r),{canUse:!1,usedToday:0,limit:0};d=e}let u=r||"PRO"===i.subscription_tier?parseInt(process.env.PRO_TIER_DAILY_LIMIT||"200"):parseInt(process.env.FREE_TIER_DAILY_LIMIT||"20");return{canUse:(d?.api_calls_used||0)<u,usedToday:d?.api_calls_used||0,limit:u}}async function l(e){let t=await (0,a.b)(),r=new Date;r.setHours(0,0,0,0);let s=r.toISOString().split("T")[0],{data:i}=await t.from("usage_tracking").select("*").eq("user_id",e).eq("date",s).single();if(i)await t.from("usage_tracking").update({api_calls_used:i.api_calls_used+1}).eq("user_id",e).eq("date",s);else{let{data:r}=await t.from("users").select("subscription_tier").eq("id",e).single();await t.from("usage_tracking").insert({user_id:e,date:s,api_calls_used:1,tier:r?.subscription_tier||"FREE"})}}},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},23469:(e,t,r)=>{"use strict";r.d(t,{$:()=>l});var s=r(37413);r(61120);var a=r(70403),i=r(50662),n=r(10974);let o=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function l({className:e,variant:t,size:r,asChild:i=!1,...l}){let c=i?a.DX:"button";return(0,s.jsx)(c,{"data-slot":"button",className:(0,n.cn)(o({variant:t,size:r,className:e})),...l})}},24982:(e,t,r)=>{"use strict";r.d(t,{t:()=>n});var s=r(5069),a=r(12909),i=r(36463);async function n(e,t=1,r=10){try{let n=await (0,a.hS)(e),o=await (0,s.L)(),l=(t-1)*r,{data:c,error:d}=await o.from("submissions").select(`
        id,
        question,
        subject,
        exam_board,
        created_at,
        feedback (
          score,
          grade
        )
      `).eq("user_id",e).order("created_at",{ascending:!1}).range(l,l+r-1);if(d)throw i.v.error("Error fetching recent submissions:",d),d;let{count:u,error:g}=await o.from("submissions").select("*",{count:"exact",head:!0}).eq("user_id",e);if(g)throw i.v.error("Error counting submissions:",g),g;let{data:h,error:m}=await o.from("submissions").select(`
        id,
        created_at,
        feedback (
          score,
          grade,
          created_at
        )
      `).eq("user_id",e).not("feedback","is",null).order("created_at",{ascending:!1});if(m)throw i.v.error("Error fetching submissions with feedback:",m),m;let x=h&&h.length>0?h.reduce((e,t)=>e+(t.feedback?.[0]?.score||0),0)/h.length:0,p=c?.reduce((e,t)=>{let r=t.subject||"Other";return e[r]=(e[r]||0)+1,e},{})||{},b=new Date;b.setDate(b.getDate()-30);let v=(h?.filter(e=>new Date(e.created_at)>=b)||[]).reduce((e,t)=>{let r=t.created_at.split("T")[0];return e[r]||(e[r]={total:0,count:0}),e[r].total+=t.feedback?.[0]?.score||0,e[r].count+=1,e},{}),f=Object.entries(v).map(([e,t])=>({date:e,score:t.total/t.count,count:t.count})),y=h?.reduce((e,t)=>{let r=t.feedback?.[0]?.grade||"N/A";return e[r]=(e[r]||0)+1,e},{})||{},w=c?.map(e=>({id:e.id,question:(e.question||"").substring(0,100)+((e.question||"").length>100?"...":""),subject:e.subject,examBoard:e.exam_board,createdAt:e.created_at,score:e.feedback?.[0]?.score||0,grade:e.feedback?.[0]?.grade||"N/A"}))||[],j=Math.ceil((u||0)/r),N={recentSubmissions:w,analytics:{totalSubmissions:u||0,averageScore:x,subjectBreakdown:p,progressOverTime:f,gradeDistribution:y},usage:{used:n.usedToday,limit:n.limit,remaining:n.limit-n.usedToday,canUse:n.canUse},pagination:{page:t,limit:r,total:u||0,totalPages:j}};return{...N,usage:{...N.usage,percentage:N.usage.used/N.usage.limit*100}}}catch(e){throw i.v.error("Error in getDashboardData:",e),e}}},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30084:(e,t,r)=>{"use strict";r.d(t,{E:()=>l});var s=r(37413);r(61120);var a=r(70403),i=r(50662),n=r(10974);let o=(0,i.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function l({className:e,variant:t,asChild:r=!1,...i}){let l=r?a.DX:"span";return(0,s.jsx)(l,{"data-slot":"badge",className:(0,n.cn)(o({variant:t}),e),...i})}},31158:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(62688).A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},35950:(e,t,r)=>{"use strict";r.d(t,{Separator:()=>n});var s=r(60687);r(43210);var a=r(62369),i=r(4780);function n({className:e,orientation:t="horizontal",decorative:r=!0,...n}){return(0,s.jsx)(a.b,{"data-slot":"separator",decorative:r,orientation:t,className:(0,i.cn)("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...n})}},36463:(e,t,r)=>{"use strict";r.d(t,{v:()=>a});class s{constructor(){this.logLevel=process.env.NEXT_PUBLIC_LOG_LEVEL||"info",this.setupProductionLogging()}static getInstance(){return s.instance||(s.instance=new s),s.instance}shouldLog(e){let t={debug:0,info:1,warn:2,error:3};return t[e]>=t[this.logLevel]}formatMessage(e,t,r){let s=new Date().toISOString(),a=r?` ${JSON.stringify(r)}`:"";return`[${s}] [${e.toUpperCase()}] ${t}${a}`}async setupProductionLogging(){try{let{getEnvVar:e}=await Promise.resolve().then(r.bind(r,43294)),t=await e("LOGGING_SERVICE");if("sentry"===t)await e("SENTRY_DSN")&&console.warn("Sentry logging not available in Cloudflare Workers environment");else if("logflare"===t){let t=await e("LOGFLARE_API_KEY"),r=await e("LOGFLARE_SOURCE_ID");t&&r&&console.warn("Winston-Logflare logging not available in Cloudflare Workers environment")}else if("datadog"===t){let t=await e("DATADOG_API_KEY");if(t){let{datadogLogs:e}=await r.e(6666).then(r.bind(r,96666));e.init({clientToken:t,site:"datadoghq.com",forwardErrorsToLogs:!0}),this.productionLogger=e}}}catch(e){console.error("Failed to initialize production logging:",e)}}debug(e,t){this.shouldLog("debug")&&console.debug(this.formatMessage("debug",e,t))}info(e,t){this.shouldLog("info")&&(console.info(this.formatMessage("info",e,t)),this.productionLogger&&(this.productionLogger.captureMessage?this.productionLogger.captureMessage(e,"info",t):this.productionLogger.logger&&this.productionLogger.logger.info(e,t)))}warn(e,t){this.shouldLog("warn")&&(console.warn(this.formatMessage("warn",e,t)),this.productionLogger&&(this.productionLogger.captureMessage?this.productionLogger.captureMessage(e,"warning",t):this.productionLogger.logger&&this.productionLogger.logger.warn(e,t)))}error(e,t,r){if(this.shouldLog("error")){let s=t?{error:t.message||t,stack:t.stack}:{};console.error(this.formatMessage("error",e,{...r,...s})),this.productionLogger&&(this.productionLogger.captureException?this.productionLogger.captureException(t||Error(e),{contexts:{context:r}}):this.productionLogger.logger&&this.productionLogger.logger.error(e,{...r,...s}))}}}let a=s.getInstance()},40228:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(62688).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},41862:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(62688).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},43294:(e,t,r)=>{"use strict";r.d(t,{getEnvVar:()=>i});var s=r(62426);async function a(){try{return(await (0,s.DM)()).env}catch(e){return process.env}}async function i(e){return(await a())[e]}},46771:(e,t,r)=>{"use strict";r.d(t,{SubscriptionManager:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call SubscriptionManager() from the server but SubscriptionManager is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/new_username/Documents/projects/aiamrkerv2/worktrees/claude/src/components/subscription/subscription-manager.tsx","SubscriptionManager")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},56621:(e,t,r)=>{"use strict";r.d(t,{b:()=>n});var s=r(66437),a=r(43294);let i=null;async function n(){if(!i){let e=await (0,a.getEnvVar)("NEXT_PUBLIC_SUPABASE_URL"),t=await (0,a.getEnvVar)("NEXT_PUBLIC_SUPABASE_ANON_KEY");if(!e||!t)throw Error("Missing Supabase configuration");i=(0,s.UU)(e,t)}return i}(0,s.UU)("https://tqlnqqrrpzmdpgijxiqk.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRxbG5xcXJycHptZHBnaWp4aXFrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTExMTUwNjAsImV4cCI6MjA2NjY5MTA2MH0.ZDCY7DSswAgcUHFlDl3S0BDDXpX3qmyViWXsIGFhwkw")},58580:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>y});var s=r(37413),a=r(12909),i=r(39916),n=r(46771),o=r(78963),l=r(30084),c=r(23469),d=r(12304),u=r(26373);let g=(0,u.A)("settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),h=(0,u.A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),m=(0,u.A)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),x=(0,u.A)("palette",[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]]),p=(0,u.A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),b=(0,u.A)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),v=(0,u.A)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);var f=r(24982);async function y(){let e=await (0,a.HW)();e||(0,i.redirect)("/sign-in");let t=(await (0,f.t)(e.id)).usage;return(0,s.jsx)("div",{className:"min-h-screen bg-gray-900 p-6",children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsxs)("h1",{className:"text-3xl font-bold text-white mb-2 flex items-center gap-2",children:[(0,s.jsx)(g,{className:"h-8 w-8"}),"Settings"]}),(0,s.jsx)("p",{className:"text-gray-300",children:"Manage your account, subscription, and preferences"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,s.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,s.jsxs)(o.Zp,{className:"bg-white/5 backdrop-blur-sm border-white/10",children:[(0,s.jsxs)(o.aR,{children:[(0,s.jsxs)(o.ZB,{className:"text-white flex items-center gap-2",children:[(0,s.jsx)(h,{className:"h-5 w-5"}),"Account Information"]}),(0,s.jsx)(o.BT,{className:"text-gray-300",children:"Your profile and account details"})]}),(0,s.jsxs)(o.Wu,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"Email"}),(0,s.jsx)("p",{className:"text-white font-medium",children:e.email})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"Role"}),(0,s.jsx)(l.E,{className:"bg-blue-500/20 text-blue-300 border-blue-500/30",children:e.role})]})]}),(0,s.jsx)(d.Separator,{className:"bg-white/10"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"Member Since"}),(0,s.jsx)("p",{className:"text-white font-medium",children:new Date(e.createdAt).toLocaleDateString()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:"Last Updated"}),(0,s.jsx)("p",{className:"text-white font-medium",children:new Date(e.updatedAt).toLocaleDateString()})]})]}),(0,s.jsx)("div",{className:"pt-4",children:(0,s.jsxs)(c.$,{variant:"outline",className:"border-white/20 text-white hover:bg-white/10",disabled:!0,children:[(0,s.jsx)(m,{className:"h-4 w-4 mr-2"}),"Manage Account (Coming Soon)"]})})]})]}),(0,s.jsxs)(o.Zp,{className:"bg-white/5 backdrop-blur-sm border-white/10",children:[(0,s.jsxs)(o.aR,{children:[(0,s.jsxs)(o.ZB,{className:"text-white flex items-center gap-2",children:[(0,s.jsx)(x,{className:"h-5 w-5"}),"Preferences"]}),(0,s.jsx)(o.BT,{className:"text-gray-300",children:"Customize your experience"})]}),(0,s.jsxs)(o.Wu,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-400 text-sm mb-2",children:"Theme"}),(0,s.jsx)(l.E,{className:"bg-gray-500/20 text-gray-300 border-gray-500/30",children:"Dark Mode"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-400 text-sm mb-2",children:"Language"}),(0,s.jsx)(l.E,{className:"bg-gray-500/20 text-gray-300 border-gray-500/30",children:"English (UK)"})]})]}),(0,s.jsx)(d.Separator,{className:"bg-white/10"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-white font-medium",children:"Email Notifications"}),(0,s.jsx)("p",{className:"text-gray-400 text-sm",children:"Receive updates about new features"})]}),(0,s.jsx)(l.E,{className:"bg-green-500/20 text-green-300 border-green-500/30",children:"Enabled"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-white font-medium",children:"Usage Reminders"}),(0,s.jsx)("p",{className:"text-gray-400 text-sm",children:"Daily limit notifications"})]}),(0,s.jsx)(l.E,{className:"bg-green-500/20 text-green-300 border-green-500/30",children:"Enabled"})]})]})]})]}),(0,s.jsxs)(o.Zp,{className:"bg-white/5 backdrop-blur-sm border-white/10",children:[(0,s.jsxs)(o.aR,{children:[(0,s.jsxs)(o.ZB,{className:"text-white flex items-center gap-2",children:[(0,s.jsx)(p,{className:"h-5 w-5"}),"Privacy & Security"]}),(0,s.jsx)(o.BT,{className:"text-gray-300",children:"Your data and privacy controls"})]}),(0,s.jsxs)(o.Wu,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-white font-medium",children:"Data Collection"}),(0,s.jsx)("p",{className:"text-gray-400 text-sm",children:"Analytics and performance data"})]}),(0,s.jsx)(l.E,{className:"bg-blue-500/20 text-blue-300 border-blue-500/30",children:"Minimal"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-white font-medium",children:"Submission History"}),(0,s.jsx)("p",{className:"text-gray-400 text-sm",children:"Your answers and feedback"})]}),(0,s.jsx)(l.E,{className:"bg-green-500/20 text-green-300 border-green-500/30",children:"Encrypted"})]})]}),(0,s.jsx)(d.Separator,{className:"bg-white/10"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)(c.$,{variant:"outline",className:"border-white/20 text-white hover:bg-white/10",children:[(0,s.jsx)(b,{className:"h-4 w-4 mr-2"}),"Privacy Policy"]}),(0,s.jsxs)(c.$,{variant:"outline",className:"border-white/20 text-white hover:bg-white/10",children:[(0,s.jsx)(v,{className:"h-4 w-4 mr-2"}),"Data Export"]})]})]})]})]}),(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsx)(n.SubscriptionManager,{subscription:null,usage:t||{used:0,limit:20,percentage:0}})})]})]})})}},62369:(e,t,r)=>{"use strict";r.d(t,{b:()=>c});var s=r(43210),a=r(14163),i=r(60687),n="horizontal",o=["horizontal","vertical"],l=s.forwardRef((e,t)=>{var r;let{decorative:s,orientation:l=n,...c}=e,d=(r=l,o.includes(r))?l:n;return(0,i.jsx)(a.sG.div,{"data-orientation":d,...s?{role:"none"}:{"aria-orientation":"vertical"===d?d:void 0,role:"separator"},...c,ref:t})});l.displayName="Separator";var c=l},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},68741:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>g,tree:()=>c});var s=r(65239),a=r(48088),i=r(88170),n=r.n(i),o=r(30893),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let c={children:["",{children:["settings",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,58580)),"/home/new_username/Documents/projects/aiamrkerv2/worktrees/claude/src/app/settings/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"/home/new_username/Documents/projects/aiamrkerv2/worktrees/claude/src/app/layout.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,67393)),"/home/new_username/Documents/projects/aiamrkerv2/worktrees/claude/src/app/loading.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["/home/new_username/Documents/projects/aiamrkerv2/worktrees/claude/src/app/settings/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},g=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/settings/page",pathname:"/settings",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},68763:(e,t,r)=>{Promise.resolve().then(r.bind(r,86347)),Promise.resolve().then(r.bind(r,35950))},74075:e=>{"use strict";e.exports=require("zlib")},78963:(e,t,r)=>{"use strict";r.d(t,{BT:()=>l,Wu:()=>c,ZB:()=>o,Zp:()=>i,aR:()=>n});var s=r(37413);r(61120);var a=r(10974);function i({className:e,...t}){return(0,s.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...t})}function n({className:e,...t}){return(0,s.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...t})}function o({className:e,...t}){return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",e),...t})}function l({className:e,...t}){return(0,s.jsx)("div",{"data-slot":"card-description",className:(0,a.cn)("text-muted-foreground text-sm",e),...t})}function c({className:e,...t}){return(0,s.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",e),...t})}},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},84027:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(62688).A)("settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},85778:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(62688).A)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},86347:(e,t,r)=>{"use strict";r.d(t,{SubscriptionManager:()=>S});var s=r(60687),a=r(43210),i=r(29523),n=r(44493),o=r(96834),l=r(35950),c=r(29867),d=r(99891),u=r(85778),g=r(41862),h=r(84027),m=r(25334),x=r(31158),p=r(25541),b=r(12640),v=r(40228),f=r(48482),y=r(2041),w=r(85168),j=r(27747),N=r(19598),k=r(64635),_=r(515);let E=(e,t)=>"PPP"===t?e.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):e.toLocaleDateString();function S({subscription:e,usage:t}){let[r,S]=(0,a.useState)(!1),{toast:A}=(0,c.dj)(),{data:L,loading:P,error:D}=function(e=30){let[t,r]=(0,a.useState)(null),[s,i]=(0,a.useState)(!0),[n,o]=(0,a.useState)(null);return{data:t,loading:s,error:n,refetch:(0,a.useCallback)(async()=>{try{i(!0),o(null);let t=await fetch(`/api/usage/history?days=${e}`);if(!t.ok)throw Error("Failed to fetch usage history");let s=await t.json();r(s)}catch(e){o(e instanceof Error?e.message:"An error occurred")}finally{i(!1)}},[e])}}(30),M=async()=>{if(!e?.stripeCustomerId)return void A({title:"No Subscription",description:"You need an active subscription to manage billing",variant:"destructive"});S(!0);try{let e=await fetch("/api/stripe/create-portal-session",{method:"POST"}),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to create portal session");window.open(t.url,"_blank")}catch(e){A({title:"Portal Error",description:e instanceof Error?e.message:"Failed to open billing portal",variant:"destructive"})}finally{S(!1)}};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)(n.Zp,{className:"bg-white/5 backdrop-blur-sm border-white/10",children:[(0,s.jsxs)(n.aR,{children:[(0,s.jsxs)(n.ZB,{className:"text-white flex items-center gap-2",children:[(0,s.jsx)(d.A,{className:"h-5 w-5"}),"Current Plan"]}),(0,s.jsx)(n.BT,{className:"text-gray-300",children:"Your subscription details and usage"})]}),(0,s.jsxs)(n.Wu,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-gray-300",children:"Plan"}),(0,s.jsx)(o.E,{className:"PRO"===(e?.tier||"FREE")?"bg-blue-500/20 text-blue-300 border-blue-500/30":"bg-gray-500/20 text-gray-300 border-gray-500/30",children:e?.tier||"FREE"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-gray-300",children:"Status"}),(0,s.jsx)(o.E,{className:(e=>{switch(e){case"ACTIVE":return"bg-green-500/20 text-green-300 border-green-500/30";case"PAST_DUE":return"bg-yellow-500/20 text-yellow-300 border-yellow-500/30";case"CANCELLED":return"bg-red-500/20 text-red-300 border-red-500/30";default:return"bg-gray-500/20 text-gray-300 border-gray-500/30"}})(e?.status||"FREE"),children:e?.status||"FREE"})]}),(0,s.jsx)(l.Separator,{className:"bg-white/10"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-gray-300",children:"Daily Usage"}),(0,s.jsxs)("span",{className:"text-white font-medium",children:[t.used," / ",t.limit]})]}),(0,s.jsx)("div",{className:"w-full bg-gray-800 rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${Math.min(t.percentage,100)}%`}})}),(0,s.jsxs)("p",{className:"text-sm text-gray-400",children:[t.percentage.toFixed(1),"% of daily limit used"]})]}),e&&"ACTIVE"===e.status&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.Separator,{className:"bg-white/10"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-400 text-sm",children:"Billing Period Start"}),(0,s.jsx)("p",{className:"text-white font-medium",children:E(new Date(e.currentPeriodStart),"PPP")})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-400 text-sm",children:"Next Billing Date"}),(0,s.jsx)("p",{className:"text-white font-medium",children:E(new Date(e.currentPeriodEnd),"PPP")})]})]})]})]})]}),e&&e.stripeCustomerId&&(0,s.jsxs)(n.Zp,{className:"bg-white/5 backdrop-blur-sm border-white/10",children:[(0,s.jsxs)(n.aR,{children:[(0,s.jsxs)(n.ZB,{className:"text-white flex items-center gap-2",children:[(0,s.jsx)(u.A,{className:"h-5 w-5"}),"Billing Management"]}),(0,s.jsx)(n.BT,{className:"text-gray-300",children:"Manage your subscription, payment methods, and billing history"})]}),(0,s.jsx)(n.Wu,{children:(0,s.jsx)(i.$,{onClick:M,disabled:r,className:"w-full bg-white/10 hover:bg-white/20 text-white",children:r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Opening Portal..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"Manage Subscription",(0,s.jsx)(m.A,{className:"h-4 w-4 ml-2"})]})})})]}),(0,s.jsxs)(n.Zp,{className:"bg-white/5 backdrop-blur-sm border-white/10",children:[(0,s.jsxs)(n.aR,{children:[(0,s.jsxs)(n.ZB,{className:"text-white flex items-center gap-2",children:[(0,s.jsx)(x.A,{className:"h-5 w-5"}),"Usage History"]}),(0,s.jsx)(n.BT,{className:"text-gray-300",children:"Track your AI marking usage over time"})]}),(0,s.jsx)(n.Wu,{children:P?(0,s.jsx)("div",{className:"flex justify-center py-8",children:(0,s.jsx)(g.A,{className:"h-8 w-8 animate-spin text-blue-400"})}):D?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)("p",{className:"text-red-400 mb-2",children:"Error loading usage history"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:D})]}):L&&L.dailyUsage.length>0?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-white",children:L.stats.totalApiCalls}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Total API Calls"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-white",children:L.stats.averageDailyUsage}),(0,s.jsx)("p",{className:"text-sm text-gray-400",children:"Daily Average"})]})]}),0!==L.stats.weeklyChange&&(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[L.stats.weeklyChange>0?(0,s.jsx)(p.A,{className:"h-4 w-4 text-green-400"}):(0,s.jsx)(b.A,{className:"h-4 w-4 text-red-400"}),(0,s.jsxs)("span",{className:`text-sm ${L.stats.weeklyChange>0?"text-green-400":"text-red-400"}`,children:[Math.abs(L.stats.weeklyChange),"% vs last week"]})]}),(0,s.jsx)("div",{className:"h-48",children:(0,s.jsx)(f.u,{width:"100%",height:"100%",children:(0,s.jsxs)(y.E,{data:L.dailyUsage.slice(0,7).reverse(),children:[(0,s.jsx)(w.d,{strokeDasharray:"3 3",stroke:"#374151",opacity:.3}),(0,s.jsx)(j.W,{dataKey:"date",stroke:"#9ca3af",fontSize:12,tickFormatter:e=>new Date(e).toLocaleDateString("en-GB",{day:"numeric",month:"short"})}),(0,s.jsx)(N.h,{stroke:"#9ca3af",fontSize:12}),(0,s.jsx)(k.m,{contentStyle:{backgroundColor:"#1f2937",border:"1px solid #374151",borderRadius:"8px",color:"#fff"},formatter:e=>[`${e} calls`,"Usage"]}),(0,s.jsx)(_.y,{dataKey:"usage",fill:"#3b82f6",radius:[4,4,0,0]})]})})}),(0,s.jsxs)(i.$,{onClick:()=>{let e=new Blob([[["Date","API Calls","Tier"],...L.dailyUsage.map(e=>[e.date,e.usage,e.tier])].map(e=>e.join(",")).join("\n")],{type:"text/csv"}),t=window.URL.createObjectURL(e),r=document.createElement("a");r.href=t,r.download=`usage-history-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(t)},className:"w-full bg-white/10 hover:bg-white/20 text-white",children:[(0,s.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Export as CSV"]})]}):(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)(v.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-400 mb-2",children:"No usage history yet"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Start using AI marking to see your usage data"})]})})]})]})}},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},99891:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(62688).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4243,2822,111,1658,3928,4513,6923,9935,9852],()=>r(68741));module.exports=s})();